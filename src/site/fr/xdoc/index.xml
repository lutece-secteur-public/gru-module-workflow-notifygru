<?xml version="1.0" encoding="UTF-8"?>
<document>
    <properties>
        <title>       
          Module workflow NotifyGru : Task to send GRU notifications
        </title>
    </properties>
    <head>
        <meta name="keywords" content="notification, mail, sms, workflow"/>
    </head>
    <body>
        <section name="Module workflow NotifyGru ">
            <!--
            <p>
                <img src="images/moduleworkflownotifygru.png" />
            </p>
            -->
            
             <subsection name="Introduction">
              Notify Gru The module is a workflow task that build a notification from a resource  and  send it.
              The notification can be of the type Mail, JSON...
            </subsection>
           
             <subsection name="Configuration">
                <p> NotifyGru requires the library-notifygru to send the notification.</p>
                <p> This library provides "Notifiers" that correspond to each type of notification (mail, sms, ...)</p>
                <p> The "notifiers" should be injected as beans in the context of the module to be used, examples : </p>
                
                <pre>
      &lt;!--  NotificationStore Rest (with ApiManager access) : --&gt; 
    &lt;bean id="workflow-notifygru.lib-notifygru.apiManagerTransport"
        class="fr.paris.lutece.plugins.librarynotifygru.rs.service.NotificationTransportApiManagerRest"&gt;
        &lt;property name="notificationEndPoint"&gt;
            &lt;value&gt;${library-notifygru.NotificationStoreNotifierService.notificationEndPoint}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="apiManagerEndPoint"&gt;
            &lt;value&gt;${library-notifygru.NotificationStoreNotifierService.apiManagerEndPoint}&lt;/value&gt;
        &lt;/property&gt;
        &lt;property name="apiManagerCredentials"&gt;
            &lt;value&gt;${library-notifygru.NotificationStoreNotifierService.apiManagerCredentials}&lt;/value&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
    &lt;bean id="workflow-notifygru.lib-notifygru.notificationStoreNotifierRestService"
        class="fr.paris.lutece.plugins.librarynotifygru.services.NotificationStoreNotifierRestService"&gt;
        &lt;constructor-arg
            ref="workflow-notifygru.lib-notifygru.apiManagerTransport" /&gt;
    &lt;/bean&gt;
	
	
	&lt;!-- Email : --&gt;
  	&lt;bean id="workflow-notifygru.lib-notifygru.emailNotifierService"
        class="fr.paris.lutece.plugins.librarynotifygru.services.EmailNotifierService"&gt;
    &lt;/bean&gt;
    

	&lt;!-- BroadCast Email : --&gt;
  	&lt;bean id="workflow-notifygru.lib-notifygru.broadcastEmailNotifierService"
        class="fr.paris.lutece.plugins.librarynotifygru.services.BroadcastEmailNotifierService"&gt;
    &lt;/bean&gt;
    
    
    &lt;!-- Mock : --&gt;
  	&lt;bean id="workflow-notifygru.lib-notifygru.MockNotifierService"
        class="fr.paris.lutece.plugins.librarynotifygru.services.MockNotifierService"&gt;
    &lt;/bean&gt;
                
                </pre>
                  
                <p> See example in the workflow-notifygru_context.xml file, or the library-notifygru repository for more details about this configuration.</p>
                <p> </p>
                
                <p>Notify Gru can use extra information providers to include in the content of the notification. </p>
                <p>Those providers are provided by the different type of workflow resources that can use this notification task 
                ( forms, appointment, ...)</p>
                <p>There are two types of resource provider :  </p>
                <p>
      <ul>
         <li> <strong>The resource providers :  </strong> <p/>
       A resource provider is the link between the NotifyGru task and a simple set of workflow resource infos.
         </li>
         <li> <strong>The resource providers managers:  </strong><p/>
         A resource provider manager is the link between the
          notifygru task and multiple sets of resources infos (for example, in the plugin forms each form corresponds to a provider. ) </li>
      </ul>
   </p>
   <p/>
   <p>Resources are treated as "demands", which contain information such as id, type, user reference, etc... 
   and thus all notifications corresponding to the same resource will be attached to this "demand" entity.</p>
            </subsection>
            
            
            
           
            <subsection name="Usage">
                    <p> <strong>La configuration de NotifyGru se fait en deux étapes : </strong></p>
                    <strong>A first page with two fields:  </strong>
                     <ul>
                     <li> A list to choose the provider of
                      resource among different implementations of the available providers</li>
                     <li>The status checkbox field  : the demand will be considered as "closed" if checked. </li>
                     </ul>
                    
                 <p>Then NotifyGru configuration is done on multiple tabs. 
                 To set up a tab you must activate it via the select input "Add a notification ...". 
                 (Only the available  notifications types are proposed, regarding the type of injected Notifiers)
For each tab you can use bookmarks resource provider to enrich dynamically the message or the  subject. </p>
               
                <strong>Onglet Tableau de Bord  :  </strong>
         
         <ul>
         <li> Status (required) : new status of the demand </li>
         <li>Serder Name (required): the message sender </li>
         <li>Subject (required): subject of the notification (May use bookmarks)</li>
         <li>Message (required): Message of the notification (May use bookmarks)</li>    
         <li>Nombre d'étapes (optionnel) : nombre total d'étapes de la demande </li>
         <li>Current Step (optional): current step when sending the notification</li>
         </ul>
      
<p/>
         
         
       <strong>View Tab Agent 360°: </strong>         
         <ul>
         <li>Status in the 360° View (required) : status for the 360° view</li>
         <li>Event Description in the 360 ° View (required): message to the view 360. (May use bookmarks)</li>    
         </ul>
  <p/>       
        
         
         
         <strong>Onglet MAIL : </strong>
         <ul>
         <li>Expéditeur (obligatoire) : expéditeur de l'email</li>
         <li>Subject (required) email subject. (May use bookmarks)</li>    
         <li>Cc (optionnel) : en copie conforme </li>
         <li>Cci (optionnel) : encopie conforme invisible.</li>
         <li>Message  (ogligatoire) : message de l'email. (May use bookmarks)</li>    
         </ul>
     
     <p/>
     
      
 <strong>Onglet SMS : </strong>
         <ul>
         <li>Message (required): the SMS. (May use bookmarks)</li>    
         </ul>
      
<p/>
      <strong>Onglet Liste de diffusion : </strong>         
          <ul>
         <li>mailing list (required): list of recipients, separated with ";"</li>
         <li>Sender (required): email of the sender</li>
         <li>Subject (required): subject (May use bookmarks)</li>    
        <li>Cc (optionnel) : en copie conforme </li>
         <li>Cci (optionnel) : encopie conforme invisible.</li>
         <li>Message (required) : the main content (May use bookmarks)</li>    
         </ul>
       <p/>
         
            </subsection>
            
        </section>
    </body>
</document>
